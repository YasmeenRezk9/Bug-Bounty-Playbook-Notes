---
description: XML External Entity (XXE)
---

# XXE

## <mark style="color:yellow;">Basics of XML</mark>

Extensible Markup Language (XML) is a language designed to store and transport data similar to JSON.

<figure><img src="../../.gitbook/assets/image (10).png" alt=""><figcaption><p>The basic structure of XML</p></figcaption></figure>

If you ever see this line in burp you should test for XXE:

* \<?xml version="1.0" encoding="UTF-8"?>

Document Type Definition (DTD) defines the structure and the legal elements and attributes of an XML document:

* Here an ENTITY acts as a variable called “user” and holds the text “Ghostlulz”.

<figure><img src="../../.gitbook/assets/image (48).png" alt=""><figcaption><p>Document Type Definition</p></figcaption></figure>

Note that an external entity loads its data from an external source, for example:

* \<!DOCTYPE foo \[\<!ENTITY ext SYSTEM "http://example.com">]>
* \<!DOCTYPE foo \[\<!ENTITY ext SYSTEM "file:///path/to/file">]>

## <mark style="color:yellow;">XXE</mark>

Whenever you see XML you should test for XXE.

<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption></figcaption></figure>

In order to read the data the entity must be returned in the response, So:

* &#x20;if we can use external entities to grab data from a file on disk and store it in a variable, we can try to read data from the “/etc/passwd” file and store it in a variable.

#### Testing for XXE

1. put in your malicious external entity and replace each node value with it, like:

* Here we created an external entity to grab the data in the “/etc/passwd” file and stored it in the entity XXE then placed the variable in the "\<productID>" node.

<figure><img src="../../.gitbook/assets/image (30).png" alt=""><figcaption><p>XXE payload</p></figcaption></figure>

2. If the server doesn’t block external entities the response will be reflected to you, like:

<figure><img src="../../.gitbook/assets/image (54).png" alt=""><figcaption><p>Use XXE to read /etc/passwd file</p></figcaption></figure>

The vulnerable application used can be found at [**https://portswigger.net/web-security**](https://portswigger.net/web-security)
